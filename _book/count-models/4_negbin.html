<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Negative Binomial (NB-2)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../_lib/quarto-nav/quarto-nav.js"></script>
<script src="../_lib/quarto-nav/headroom.min.js"></script>
<script src="../_lib/clipboard/clipboard.min.js"></script>
<script src="../_lib/quarto-search/autocomplete.umd.js"></script>
<script src="../_lib/quarto-search/fuse.min.js"></script>
<script src="../_lib/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../count-models/5_genpois.html" rel="next">
<link href="../count-models/3_extra_poisson_dispersion.html" rel="prev">
<script src="../_lib/quarto-html/quarto.js"></script>
<script src="../_lib/quarto-html/popper.min.js"></script>
<script src="../_lib/quarto-html/tippy.umd.min.js"></script>
<script src="../_lib/quarto-html/anchor.min.js"></script>
<link href="../_lib/quarto-html/tippy.css" rel="stylesheet">
<link href="../_lib/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../_lib/bootstrap/bootstrap.min.js"></script>
<link href="../_lib/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../_lib/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../style.css">
</head>

<body class="nav-sidebar docked fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Negative Binomial (NB-2)</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../pics/manta_ray.gif" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Statistics UW</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">count_models/0_index.qmd</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../count-models/1_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../count-models/2_poisson.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Poisson</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../count-models/3_extra_poisson_dispersion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Extra Poisson dispersion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../count-models/4_negbin.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Negative Binomial (NB-2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../count-models/5_genpois.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized Poisson</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-NB2" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Negative Binomial (NB-2)</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The derivation on the negative binomial NB2 is usually illustrated as a Poisson model with gamma heterogeneity, where the gamma noise has a mean of 1.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> An intuitive way to think of this is through the introduction of latent heterogeneity<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> (an unobserved effect) to the mean of the Poisson model (Greene, 2008).</p>
<p>Recall our Poisson model of <span class="math inline">\(y_i \sim \mathrm{poisson}(\lambda_i)\)</span> for <span class="math inline">\(\lambda_i = \mu_i = \exp(\pmb x_i \pmb\beta)\)</span><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> which has the property of equidispersion since <span class="math inline">\(E[y_i | \pmb x_i] = \mathrm{Var}[y_i | \pmb x_i] = \lambda_i\)</span>. We will alter this poisson model to account for extra variance in our data, i.e.&nbsp;overdispersion <span class="math inline">\(\mathrm{Var}[y_i | \pmb x_i] &gt; E[y_i | \pmb x_i]\)</span>. We can imagine this extra variance stemming from observation-level deviations from the mean dues to an unobserved effect; we will refer to these deviations as latent heterogeneity. Let <span class="math inline">\(\varepsilon\)</span> represent this latent heterogeneity, then we can re-express the mean as <span class="math inline">\(\mu_i^* = \exp(\pmb x_i \pmb\beta + \varepsilon_i)\)</span>. Here <span class="math inline">\(\varepsilon\)</span> is its own random variable to which we will assign a probability distribution. Now define <span class="math inline">\(h_i = \exp(\varepsilon_i)\)</span> such that</p>
<p><span class="math display">\[
y_i \sim \mathrm{poisson}(h_i\lambda_i)
\]</span></p>
<p>This is a common step in the derivation of models for overdispersed counts, where the assumed distribution of <span class="math inline">\(h_i\)</span> leads to different models and parameterizations. For the negative binomial (NB2) model we assume that <span class="math inline">\(h_i\)</span> follows a single-parameter gamma distribution</p>
<p><span class="math display">\[
h_i \sim \mathrm{gamma}(k = \theta, \; \theta)
\]</span></p>
<p>with mean 1 and variance <span class="math inline">\(\alpha = 1/\theta\)</span>. The probability density of <span class="math inline">\(h_i\)</span> is then</p>
<p><span class="math display">\[
f(h_i) =
  \frac{\theta^\theta \exp(-\theta h_i)h_i^{\theta - 1}}
       {\Gamma(\theta)}
  \; ;\;\; h_i \geq 0 ,\; \theta &gt; 0 \;.
\]</span></p>
<p>To put this in mathematical terms, the negative binomial distribution is a poisson-gamma mixture. Notice that a mean of 1 for <span class="math inline">\(h\)</span> corresponds to a mean of 0 for <span class="math inline">\(\varepsilon\)</span>, i.e.&nbsp;we account for some extra zero-centered deviation around <span class="math inline">\(\pmb x_i \pmb\beta\)</span>. To put this another way, for <span class="math inline">\(y_i \sim \mathrm{poisson}(h_i\lambda_i)\)</span>, if <span class="math inline">\(E[h_i] = 1\)</span> then we can see that <span class="math inline">\(E[y_i] = \lambda_i\)</span>. I.e. <span class="math inline">\(E[h_i] = 1\)</span> is the multiplicative equivalent of <span class="math inline">\(E[\varepsilon] = 0\)</span> in the additive case. This kind of mixing based on multiplicative heterogeneity which on average leaves the Poisson mean unchanged allows us to increase the variability in the Poisson mean, and in turn, the variability of the response. Intuitively this will lead to overdispersion and to increased probabilities of the occurrence of low counts and of high counts.</p>
<p>Now we have our latent heterogeneity within the conditional mean of the Poisson model<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> we can write the the conditional distribution <span class="math inline">\(f(y_i|x_i, h_i) = \prod^n_{i=1}g(y_i | h_i\lambda_i)\)</span> where <span class="math inline">\(g\)</span> is the probability density function of the <span class="math inline">\(\mathrm{poisson}(h_i \lambda_i)\)</span> (Gourieroux, 1984). However, since <span class="math inline">\(\varepsilon\)</span> is an unobserved variable, and therefore so is <span class="math inline">\(h\)</span>, we must integrate <span class="math inline">\(h\)</span> out to obtain the conditional distribution of interest</p>
<p><span class="math display">\[
f(y_i|x_i) = P[Y=y_i | \pmb x_i] = \int
  \frac{\exp(-h_i\lambda_i)(h_i\lambda_i)^{y_i}}
       {y_i!}\times
  \frac{\theta^\theta \exp(-\theta h_i)h_i^{\theta - 1}}
       {\Gamma(\theta)}dh_i
\]</span></p>
<p>We will spare the maths<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> and take for granted that we get</p>
<p><span id="eq-NB2"><span class="math display">\[
\boxed{
\begin{align}
\textbf{Negative binomial (NB-2)}&amp;: \quad y_i \sim \mathcal{NB}_2\left(\lambda_i \equiv \mu_i,\; \theta \equiv \alpha^{-1}\right) \\ \\
\text{ A poisson-gamma mixture }&amp; \text{with} \; y_i \sim \mathrm{poisson}(h_i \lambda_i) \text{ and } h_i \sim \mathrm{gamma}(\theta, \theta) .
\\ \\ \\
P[Y=y_i | \pmb x_i]
  &amp;= \frac{\Gamma(y_i + \theta)}
          {\Gamma(y_i + 1)\Gamma(\theta)}
     \left(\frac{\theta}
              {\theta + \mu_i}
     \right)^\theta
     \left(1- \frac{\theta}
                  {\theta + \mu_i}
     \right)^{y_i}\\ \\
  &amp;= \frac{\Gamma(y_i + 1/\alpha)}
          {\Gamma(y_i + 1)\Gamma(1/\alpha)}
     \left(\frac{1}
                {\alpha\mu_i + 1}
     \right)^{1/\alpha}
     \left(1- \frac{1}
                   {\alpha \mu_i + 1}
     \right)^{y_i} \\ \\ \\
E[y_i|\pmb x_i] &amp;= \lambda_i = \mu_i = \exp(\pmb x_i\pmb\beta)\\ \\ \\
\mathrm{Var}[y_i|\pmb x_i]
  &amp;= \mu_i\left(\frac{\mu_i}{\theta} + 1 \right)\\
  &amp;= \mu_i\big(\alpha \mu_i + 1\big)\\ \\ \\
\text{for } \; y_i \in \mathbb{Z}^{0+}, \; \theta &gt; 0, \; \text{and }&amp;\text{heterogeneity/overdispersion parameter } \alpha = 1/\theta &gt; 0.\quad
\end{align}
}
\tag{5.1}\]</span></span></p>
<p>This is the NB-2 parameterization of the negative binomial model (named by CT, 1986 in reference to the quadratic exponent of <span class="math inline">\(\mu\)</span> in the conditional variance function) — the standard parameterization for NB regression. Notice that this parameterization, resulting from the inclusion of a latent heterogeneity effect, relaxes the equidispersion restriction of the Poisson model while preserving the same conditional mean.</p>
<p>The Poisson model is nested within the NB2 model as the boundary case when <span class="math inline">\(\alpha = 0\)</span>. So is the geometric model when <span class="math inline">\(\alpha = 1\)</span>.</p>
<p>The variance to mean ratio describes the ‘extra-Poisson dispersion’ (overdispersion). Here we have <span class="math display">\[
\frac{\text{Variance}}{\text{Mean}} = \frac{\mu_i(\alpha\mu_i + 1)}{\mu_i} = \alpha\mu_i + 1
\]</span></p>
<p>Notice that the overdispersion depends on <span class="math inline">\(i\)</span>, i.e.&nbsp;it is variable. This is why the NB2 parameterization is sometimes called the variable overdisperison NB.</p>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Different names for the same thing
</div>
</div>
<div class="callout-body-container callout-body">
<p>The negative binomial PMF is found in many different forms. <span class="math inline">\(\lambda\)</span> or <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(1/\theta\)</span>, <span class="math inline">\(\alpha\)</span> could be called <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\theta\)</span> could be <span class="math inline">\(\nu\)</span>. Some authors prefer to leave the gamma scale parameter, <span class="math inline">\(\theta\)</span>, as it is. In this form the heterogeneity parameter (<span class="math inline">\(\theta\)</span>) is inversely related to the amount of Poisson overdispersion in the data. Most contemporary statisticians, however, prefer a direct relationship. Hence the use of <span class="math inline">\(\alpha = 1/\theta\)</span>.</p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Summary
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here we saw the Negative Binomial (NB-2 paramaterization) is a Poisson model with latent heterogeneity distributed as single-parameter gamma. This gamma noise overcomes the equidispersion limitation of the Poisson model, accomodating overdispersed or correlated counts through the addition of an overdispersion parameter in the NB variance, but still retain the same conditional mean. The distribution is parameterized by its mean <span class="math inline">\(\mu_i = \lambda_i\)</span> and heterogeneity parameter <span class="math inline">\(\alpha\)</span> (aka. overdispersion parameter) which is the inverse of the gamma noise parameter <span class="math inline">\(\theta\)</span>. This parameterization is intuitive in the context of regression for overdispersed counts, however many other parameterizations exist.</p>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Ponder
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here we distributed our latent heterogeneity term as gamma. What is special about the gamma distribution? What would happen if we used a different distribution? The answers could be in Hilbe (2011).</p>
</div>
</div>
<section id="sec-NB1" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sec-NB1"><span class="header-section-number">5.1</span> Negative Binomial (NB-1)</h2>
<p>The NB1 (aka linear NB, constant dispersion NB) is derived as a Poisson-gamma mixture model, however the manner of derivation differs from the traditional NB2 model. First derived by Evans (1953), it begins with the Poisson distribution</p>
<p><span class="math display">\[
y_i \sim \mathrm{Poisson}(\lambda_i); \quad
  P[Y = y_i | \lambda_i] =
  \frac{e^{-\lambda_i}\lambda_i^{y_i}}
       {y_i!}
\]</span></p>
<p>For the NB1, we assume the Poisson parameter itself is distributed gamma as</p>
<p><span class="math display">\[
\lambda_i \sim \mathrm{gamma}(\mu_i, \delta)
\]</span></p>
<p>where we assign the mean <span class="math inline">\(\mu_i = \exp(\pmb x_i \pmb\beta)\)</span> to the shape parameter, and <span class="math inline">\(\delta\)</span> is the scale parameter.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> <a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="callout-caution callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The above is shown as <span class="math inline">\(Gamma(\delta, \mu_i)\)</span> in multiple of Hilbe’s textbooks, where delta is still the scale parameter and mu the shape. Is it Gamma(shape, scale) or Gamma(scale, shape)?</p>
</div>
</div>
</div>
<p>As such, the expected value of the Poisson parameter is <span class="math inline">\(E[\lambda_i] = \mu_i/\delta\)</span> and the variance is <span class="math inline">\(\mathrm{Var}[\lambda_i] = \mu_i/\delta^2\)</span>. The resulting Poisson-gamma mixture, integrating out <span class="math inline">\(\lambda\)</span> can be defined as</p>
<p><span class="math display">\[
f(y_i|\pmb x_i) = \int^\infty_0
  \frac{e^{-\lambda_i}\lambda_i^{y_i}}
       {y_i!}
  \frac{\delta^{\mu_i}\lambda_i^{\mu_i - 1}}
       {\Gamma(\mu_i)}
  \exp(-\lambda_i\delta) \; d\lambda
\]</span></p>
<p>Sparing the math<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> we get</p>
<p><span id="eq-NB1"><span class="math display">\[
\boxed{
\begin{align}
\textbf{Negative binomial (NB-1)}&amp;: \quad y_i \sim \mathcal{NB}_1\left(\mu_i,\; \delta \equiv \alpha^{-1}\right) \\ \\
P[Y=y_i | \pmb x_i]
  &amp;= \frac{\Gamma(y_i + \mu_i)}
          {\Gamma(y_i + 1)\Gamma(\mu_i)}
     \left(\frac{\delta}
                {\delta + 1}
     \right)^{\mu_i}
     \left(\frac{1}
                   {\delta + 1}
     \right)^{y_i} \\ \\
  &amp;= \frac{\Gamma(y_i + \mu_i)}
          {\Gamma(y_i + 1)\Gamma(\mu_i)}
     \left(\frac{1}
                {\alpha + 1}
     \right)^{\mu_i}
     \left(\frac{\alpha}
                {\alpha + 1}
     \right)^{y_i} \\ \\ \\
E[y_i|\pmb x_i]
  &amp;= \frac{\exp(\pmb x_i\pmb\beta)}
          {\delta}
  = \frac{\mu_i}
          {\delta}  
  =  \alpha \mu_i\\ \\
\mathrm{Var}[y_i|\pmb x_i]
  &amp;= \frac{\mu_i (\delta + 1)}
          {\delta^2}
  =  \alpha\mu_i(\alpha + 1)\\ \\
\text{for } \; y_i \in \mathbb{Z}^{0+}, \; \delta &gt; 0, \; \text{and }&amp;\text{ heterogeneity/overdispersion parameter } \alpha = 1/\theta &gt; 0.\quad
\end{align}
}
\tag{5.2}\]</span></span></p>
<p>Again we have the nested Poisson model as the boundary case when <span class="math inline">\(\alpha = 0\)</span>.</p>
<p>The variance to mean ratio, denoting the ‘extra-Poisson dispersion’ (i.e.&nbsp;overdispersion), is</p>
<p><span class="math display">\[
\frac{\text{Variance}}{\text{Mean}} = \frac{\mu_i(\delta + 1)/\delta^2}{\mu_i/\delta} = \frac{\delta + 1}{\delta} = \alpha + 1
\]</span></p>
<p>Notice that unlike the NB2 parameterization, in which the overdispersion was variable, here the overdispersion is constant. This is why the NB1 is sometimes called the constant overdispersion NB.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
What’s in a parameterization: NB2 vs.&nbsp;NB1 (CT, 1986)
</div>
</div>
<div class="callout-body-container callout-body">
<p>The parameterization of the NB model is determined by the parameterization of the gamma heterogeneity distribution. As such, the NB2 and NB1 parameterizations imply different assumptions about the functional form of heteroscedasticity — a point which is not emphasized in the literature — and hence in general will lead to different estimates of <span class="math inline">\(\pmb\beta\)</span>. The two alternative specifications of the gamma heterogeneity distribution amount to different parameterizations in the univariate model, but where a regression component is present they lead to different models. This difference is also relevant when we consider the test of the null hypothesis that the distribution of Y is Poisson against the alternative that it is negative binomial.</p>
<p>Note that for the intercept only model <span class="math inline">\(\mu_i = \beta\)</span> (i.e.&nbsp;no <span class="math inline">\(x\)</span> variables in the model), if observations are i.i.d., the specific NB parameterization and resulting difference in model form is of no consequence.</p>
</div>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The mean of one is for technical reasons, see Hilbe (2007) s13.2.1.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Latent <em>def (adjective)</em> something which is not directly observed but is instead inferred.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The use of the exponential function in <span class="math inline">\(\mu_i = \exp(\pmb x_i \pmb\beta)\)</span> restricts the outcomes to positive counts.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><span class="math inline">\(y_i \sim \mathrm{poisson}(\lambda^*_i = h_i \lambda_i) \implies E[y_i|x_i, \varepsilon_i] = \exp(x_i\beta + \varepsilon_i) = \exp(x_i\beta)\exp(\varepsilon_i) = \lambda_i h_i.\)</span><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>See Hilbe (2011) s8.2.1 for the full NB2 derivation.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>If an offset is applied to the model, <span class="math inline">\(\mu_i = \exp(\pmb x_i\pmb \beta) + \text{offset}\)</span><a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>The gamma distribution can be expressed in terms of its shape parameter and either scale or rate parameter. The shape is commonly symboled <span class="math inline">\(k\)</span> or <span class="math inline">\(\alpha\)</span>. The scale is commonly symboled <span class="math inline">\(\theta\)</span> and is the inverse of the rate parameter <span class="math inline">\(\beta = 1/\theta\)</span>. Here, we assign <span class="math inline">\(\mu_i\)</span> to the shape, i.e.&nbsp;<span class="math inline">\(k = \mu_i\)</span> to derive the NB1 distribution. We will denote the scale parameter as <span class="math inline">\(\delta\)</span> to avoid confusion with the <span class="math inline">\(\theta\)</span> used in the NB2 derivation.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>See Hilbe (2011) s10.2.2 or Hilbe (2007) s13.1 for the full NB1 derivation.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../count-models/3_extra_poisson_dispersion.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Extra Poisson dispersion</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../count-models/5_genpois.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized Poisson</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>