<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Count models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../_lib/quarto-nav/quarto-nav.js"></script>
<script src="../_lib/quarto-nav/headroom.min.js"></script>
<script src="../_lib/clipboard/clipboard.min.js"></script>
<script src="../_lib/quarto-search/autocomplete.umd.js"></script>
<script src="../_lib/quarto-search/fuse.min.js"></script>
<script src="../_lib/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../ch_count_models/1_intro.html" rel="next">
<link href="../intro.html" rel="prev">
<script src="../_lib/quarto-html/quarto.js"></script>
<script src="../_lib/quarto-html/popper.min.js"></script>
<script src="../_lib/quarto-html/tippy.umd.min.js"></script>
<script src="../_lib/quarto-html/anchor.min.js"></script>
<link href="../_lib/quarto-html/tippy.css" rel="stylesheet">
<link href="../_lib/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../_lib/bootstrap/bootstrap.min.js"></script>
<link href="../_lib/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../_lib/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../style.css">
</head>

<body class="nav-sidebar docked fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Count models</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../pics/manta_ray.gif" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Statistics UW</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../ch_count_models/0_home.html" class="sidebar-item-text sidebar-link active">Count models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch_count_models/1_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch_count_models/2_poisson.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Poisson</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Count models</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="not-sure-where-to-put" class="level2">
<h2 class="anchored" data-anchor-id="not-sure-where-to-put">Not sure where to put…</h2>
<p>A GLM model contains 3 main components</p>
<ol type="1">
<li><p>The response distribution - we need to assume a distribution for the response variable <span class="math inline">\(y_i\)</span>, e.g.&nbsp;<span class="math inline">\(y_i \sim \mathrm{poisson}(\lambda_i)\)</span>.</p></li>
<li><p>The predictor function - a deterministic function of the covariates and model coefficients.</p></li>
<li><p>A link - between the expected value of the distribution and the predictor function.</p></li>
</ol>
<p>Never start with overdispersion or zero-inflation models. First start simple (this is always the Poisson model for count data), fit and validate the simple model and then find solutions to problems. People often think that just because we have many zeros in our data we need to use, or should use, a zero-inflated model. This is not the case - we may have covariates which can explain the excess number of zeros.</p>
<p>The Poisson distribution is a maximum-entropy distribution (least informative).</p>
<p>The log-link <span class="math inline">\(\mu_i = \exp(\eta_i) = \exp(\pmb x_i\pmb\beta)\)</span> ensures the the expected values are always positive. This is a nice restriction for count data.</p>
<p>Throughout this material we talk a lot about hetergeneity parameters, aka overdispersion parameters, aka dispersion parameters. This is not to be confused with the dispersion statistic</p>
<p>disp_stat_i = (observed data i - modelled expected value i)/sqrt(modelled var i) = residual i / sqrt(var i)</p>
<p>see SMS:ZIGLMAGLMM video @ 24:45.</p>
</section>
<section id="extra-poisson-dispersion" class="level2">
<h2 class="anchored" data-anchor-id="extra-poisson-dispersion">Extra-poisson dispersion</h2>
<p>For the poisson we have <span class="math inline">\(E[y_i | \pmb x_i] = \mathrm{Var}[y_i | \pmb x_i]\)</span>. Models which account for ‘extra-poisson dispersion’ do so through the use of an extra parameter such that <span class="math inline">\(E[y_i | \pmb x_i] = \phi\mathrm{Var}[y_i | \pmb x_i]\)</span>, for extra-poisson dispersion parameter <span class="math inline">\(\phi\)</span>.</p>
</section>
<section id="resourcesreferences" class="level2">
<h2 class="anchored" data-anchor-id="resourcesreferences">Resources/references</h2>
<ul>
<li><p><a href="https://doi.org/10.1093/biomet/40.1-2.186">Evans, 1953</a></p></li>
<li><p><a href="https://doi.org/10.1080/00401706.1973.10489112">Consul and Jain, 1973</a></p></li>
<li><p><a href="https://doi.org/10.2307/2529621">Bulmer, 1974</a></p></li>
<li><p><a href="https://doi.org/10.2307/1307766">Janardan et al, 1979</a></p></li>
<li><p><a href="https://doi.org/10.2307/1913472">Gourieroux, 1984</a></p></li>
<li><p><a href="https://doi.org/10.1002/jae.3950010104">CT, 1986</a></p></li>
<li><p><a href="https://doi.org/10.1017/CBO9781139013567">CT, 2013</a></p></li>
<li><p><a href="https://doi.org/10.1080/03610929208830766">Consul and Famoye, 1992</a></p></li>
<li><p><a href="https://doi.org/10.1002/bimj.200410102">Joe and Zhu, 2005</a></p></li>
<li><p><a href="https://doi.org/10.6339/JDS.2006.04(1).257">Famoye and Singh, 2006</a></p></li>
<li><p><a href="https://doi.org/10.1016/j.econlet.2007.10.015">Greene, 2008</a></p></li>
<li><p><a href="https://doi.org/10.1007/978-3-540-78389-3">Winkelmann, 2008</a></p></li>
<li><p><a href="https://doi.org/10.1017/CBO9780511973420">Hilbe, 2011</a></p></li>
<li><p><a href="https://www.routledge.com/Generalized-Linear-Models-and-Extensions-Fourth-Edition/Hardin-Hilbe/p/book/9781597182256">Hardon and Hilbe, 2018</a></p></li>
<li><p>https://www.youtube.com/watch?v=uGKnoAw-PFQ</p></li>
<li><p><a href="https://www.youtube.com/watch?v=ISN9SE__QOU&amp;t=909s">Statistical Methods Series: Zero-Inflated GLM and GLMM</a></p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../ch_count_models/1_intro.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Intro</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>