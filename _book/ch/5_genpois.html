<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Generalized Poisson</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../_lib/quarto-nav/quarto-nav.js"></script>
<script src="../_lib/quarto-nav/headroom.min.js"></script>
<script src="../_lib/clipboard/clipboard.min.js"></script>
<script src="../_lib/quarto-search/autocomplete.umd.js"></script>
<script src="../_lib/quarto-search/fuse.min.js"></script>
<script src="../_lib/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../summary.html" rel="next">
<link href="../ch/4_negbin.html" rel="prev">
<script src="../_lib/quarto-html/quarto.js"></script>
<script src="../_lib/quarto-html/popper.min.js"></script>
<script src="../_lib/quarto-html/tippy.umd.min.js"></script>
<script src="../_lib/quarto-html/anchor.min.js"></script>
<link href="../_lib/quarto-html/tippy.css" rel="stylesheet">
<link href="../_lib/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../_lib/bootstrap/bootstrap.min.js"></script>
<link href="../_lib/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../_lib/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../style.css">
</head>

<body class="nav-sidebar docked fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Generalized Poisson</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../pics/manta_ray.gif" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Statistics UW</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch/1_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch/2_poisson.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Poisson</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch/3_extra_poisson_dispersion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extra-poisson dispersion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch/4_negbin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Negative Binomial (NB-2)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch/5_genpois.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Generalized Poisson</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-GenPois" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Generalized Poisson</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>When there is overdispersion due to latent heterogeneity, people often assume a gamma mixture of poisson variables. Suppose that is <span class="math inline">\(\varepsilon_i\)</span> is an unobserved individual heterogeneity factor (e.g.&nbsp;an unobserved covariate), with <span class="math inline">\(\exp(\varepsilon)\)</span> following a gamma distribution with mean 1 (i.e.&nbsp;single parameter gamma distribution) and variance <span class="math inline">\(\alpha\)</span>. Now assume the response vector follows a modification of the Poisson model with mean <span class="math inline">\(\lambda^*_i = \exp(\pmb x_i \pmb\beta + \varepsilon_i)\)</span>. The result is the well-known negative binomial regression model where <span class="math inline">\(\alpha\)</span> is a nonnegative parameter, indicating the degree of overdispersion.</p>
<p>As alternative to the negative binomial for overdispersed counts we may assume the response follows a generalized poisson (GP) distribution. Originally developed by Consul and Jain (1973), it has since undergone various modifications (the <em>restricted generalized Poisson</em>, three parameterizations of a <em>hybrid generalized Poisson</em>, etc).</p>
<p>The generalized poisson model is similar to the negative binomial in that it incorporates an extra heterogeneity parameter.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> However, whereas the negative binomial hetergeneity parameter (<span class="math inline">\(\alpha\)</span>) is based on the single-parameter gamma distribution (NB2 parameterization; <a href="4_negbin.html"><span>Chapter&nbsp;4</span></a>), the heterogeneity parameter employed by the generalized poisson is based on the lognormal distribution.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> This allows modelling of both overdispersed ?<em>and</em> underdispersed data?.</p>
<p>There are several different models that are referred to as generalized poisson models.</p>
<hr>
<p>The standard parameterization comes from Consul (1989) (detailed in Consul and Famoye, 1992; shown to be a poisson mixture in Joe and Zhu, 2005). In Consul and Famoye (1992) the model is specified to deal with underdispersion to some degree, however it seems like this parameterization has been restricted to overdispersion only (<span class="math inline">\(\delta &gt; 0\)</span>) in later works (see Joe and Zhu, 2005).</p>
<!-- **CREATE MULTIPLE TABS: ONE FOR DISTRIBUTION DEFINITION AND ONE FOR THE MODEL FORM (see Consul and Famoye 1992)** -->
<p><span id="eq-GP1Dist"><span class="math display">\[
\boxed{
  \begin{align}
    \textbf{Generalized poisson} &amp; \text{ (Consul, 1989)}: \quad
    y_i \sim \mathrm{GenPois}(\theta_i, \delta)
    \\\\
    P[Y = y_i | \pmb x_i, \pmb\beta]
      &amp;= \theta_i(\theta_i + \delta y_i)^{y_i - 1}
         \frac{\exp(-\theta_i-\delta y_i)}
              {y!} \\ \\
    E[Y_i|\theta_i, \delta]
      &amp;= \mu_i = \frac{\theta_i}
                      {1-\delta} \\ \\
    \mathrm{Var}(Y_i | \theta_i, \delta)
      &amp;= \frac{\theta_i}
              {(1-\delta)^3} \\ \\
      &amp;= \frac{1}
              {(1-\delta)^2} E[y_i] \\ \\
      &amp;= \phi E[y_i]\\ \\
  \text{ for } \; y_i \in \mathbb{Z}^{0+}, \;\; \theta_i &gt; 0, \;\; &amp; \max(-1, -\theta_i/4) &lt; \delta &lt; 1, \; \text{and}\\
  \text{overdispersion parame}&amp;\text{ter } \phi = 1/(1-\delta)^2.\quad
  \end{align}
}
\tag{5.1}\]</span></span></p>
<p>When <span class="math inline">\(\delta = 0 \;\Leftrightarrow\; \phi = 1\)</span> the GP reduces to the nested Poisson distribution with parameter <span class="math inline">\(\theta_i\)</span>. When <span class="math inline">\(\delta &lt; 0 \;\Leftrightarrow\; \phi &lt; 1\)</span> we have underdispersion and for <span class="math inline">\(\delta &gt; 0 \;\Leftrightarrow\; \phi &gt; 1\)</span> we have overdispersion.</p>
<p>Consol (1989) introduce covariates into a regression model based on the GP distirbution via</p>
<p><span class="math display">\[
E[y_i] = \frac{\theta_i}{1-\delta} = \mu_i = \exp(\pmb x_i\pmb\beta)
\]</span></p>
<p>Under this parameterization the corresponding GP regression model is obtained by subbing <span class="math inline">\(\theta_i = (1-\delta)\mu_i\)</span> into <a href="#eq-GP1Dist">Equation&nbsp;<span>5.1</span></a> to get <span class="math display">\[
P(Y = y_i | \pmb x_i, \pmb \beta, \delta)
  = \frac{(1-\delta)\mu_i \big[(1 - \delta)\mu_i + \delta y_i \big]^{y_i - 1} \exp\big(-(1-\delta)\mu_i - \delta y_i \big)}{y!}
\]</span></p>
<p>for <span class="math inline">\(\mu_i &gt; 0\)</span>, <span class="math inline">\(\max(-1, -\theta_i/4) &lt; \delta \leq 1\)</span> and <span class="math inline">\(E[y_i] = \mu_i = \exp(\pmb x_i\pmb\beta)\)</span> (Yang, 2007).</p>
<!-- See Yang (2007) eq6 -->
<!-- In Consul and Famoye (1992) they use $\lambda$ as the overdispersion parameter and $\theta = \exp(\pmb x_i\pmb\beta)$. In Hardin and Hilbe (2018) they use $\delta$ for the overdispersion parameter. Here we will use $\lambda_i = \mu_i = \exp(\pmb x_i\pmb\beta)$ and $\alpha$ for the overdispersion parameter.  -->
<div class="callout-warning callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Wrong generalized poisson definition in Hilbe (2011)?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The below is from Hilbe (2011). Note that this is a different definition to that used in Consul and Famoye (1992), Joe and Zhu (2005), and Hardin and Hilbe (2018). Is this an error? Perhaps there is equality between the two and I just don’t see it. I will steer clear of the Hilbe (2011) definition.</p>
<p><img src="resources/potential_error_Hilbe_2011_NegBinReg_at_genpoisson_definition.PNG" class="img-fluid"></p>
</div>
</div>
</div>
<p>The value <span class="math inline">\(\theta\)</span> serves as the heterogeneity parameter, analogous to the negative binomial heterogeneity parameter <span class="math inline">\(\alpha\)</span>, and reflects the amount of ‘extra-poisson’ dispersion in the data. As with the NB <span class="math inline">\(\alpha\)</span>, as <span class="math inline">\(\theta\)</span> approaches zero this parameterization reduces to the Poisson distribution.</p>
<hr>
<p>Another well-known parameterization is given in Famoye and Singh (2006) and Winkelmann (2008).</p>
<p><span class="math display">\[
\boxed{
  \begin{align}
    \textbf{Generalized poisson} &amp; \text{ - Famoye and Singh (2006) parameterization} \\ \\
    P[Y = y_i | \mu_i, \alpha]
      &amp;= \left(
            \frac{\mu_i}
                 {\alpha\mu_i + 1}
          \right)^{y_i}
          \left(
            \frac{(\alpha y_i + 1)^{y_i - 1}}
                 {y!}
          \right)
          \exp\left(
            \frac{-\mu_i(\alpha y_i + 1)}
                 {\alpha \mu_i + 1}
          \right)
    \\ \\
    E[y_i|\mu_i, \alpha]
      &amp;= \mu_i \\ \\
    \mathrm{Var}[y_i | \mu_i, \alpha]
      &amp;= \mu_i(1 - \alpha\mu_i)^2 \\ \\
  \text{for heterogeneity }&amp;\text{parameter } \alpha.
  \end{align}
}
\]</span></p>
<p>for heterogeneity parameter <span class="math inline">\(\alpha\)</span>. Again, as <span class="math inline">\(\alpha \to 0\)</span>, this generalized Poisson distribution is reduced to the Poisson.</p>
<section id="summary" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">5.1</span> Summary</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Family"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Parameterization"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Heterogeneity parameter"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Nested models"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Extra-poisson dispersion"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>() <span class="sc">|&gt;</span>  </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">c</span>(</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Negative Binomial"</span>, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NB2"</span>, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\\</span><span class="st">alpha"</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Poisson ($</span><span class="sc">\\</span><span class="st">alpha = 0)"</span>, </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">""</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add more rows here</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">&lt;-</span> col_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Heterogeneity parameter <em>a.k.a.</em> overdispersion parameter, dispersion parameter.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This type of poisson-lognormal mixture model was first used in species abundance literature (Bulmer ,1974). See Janardan et al (1979) for biological applications of the generalized (Lagrangian) poisson distribution as well as some biological interpretations of the hetergeneity parameter. Other examples are given in Consul (1989).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../ch/4_negbin.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Negative Binomial (NB-2)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../summary.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>